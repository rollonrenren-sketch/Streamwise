<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MFS - Modern Movie Streaming</title>
    <style>
        /* Modern Movie Website - Complete Professional CSS */
        
        :root {
            /* Modern Dark Theme */
            --primary-accent: #8b5cf6;
            --primary-light: #a78bfa;
            --primary-dark: #7c3aed;
            --bg-primary: #0f0f1e;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --text-primary: #ffffff;
            --text-secondary: #e2e8f0;
            --text-muted: #94a3b8;
            --hover-bg: rgba(139, 92, 246, 0.15);
            --border-subtle: rgba(139, 92, 246, 0.2);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.5);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.6);
            --shadow-lg: 0 10px 25px rgba(139, 92, 246, 0.3);
        }

        [data-theme="light"] {
            /* Light Theme */
            --primary-accent: #7c3aed;
            --primary-light: #8b5cf6;
            --primary-dark: #6d28d9;
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --bg-card: #f1f3f5;
            --text-primary: #1a1a2e;
            --text-secondary: #495057;
            --text-muted: #6c757d;
            --hover-bg: rgba(124, 58, 237, 0.08);
            --border-subtle: rgba(124, 58, 237, 0.15);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(124, 58, 237, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
        }

        /* Navbar */
        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 4%;
            background: rgba(15, 15, 30, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-subtle);
            box-shadow: var(--shadow-sm);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .navbar.scrolled {
            background: rgba(26, 26, 46, 0.98);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        @keyframes logoGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(139, 92, 246, 0.3); }
            50% { box-shadow: 0 0 20px rgba(139, 92, 246, 0.6); }
        }

        .navbar-logo img {
            height: 45px;
            width: 45px;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: logoFloat 3s ease-in-out infinite;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.3);
        }

        .navbar-logo img:hover {
            transform: scale(1.1) rotate(5deg);
            animation: logoGlow 1s ease-in-out infinite;
        }

        .nav-links {
            display: flex;
            gap: 28px;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--primary-accent);
        }

        .search-bar {
            padding: 8px 16px;
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: all 0.2s;
            min-width: 200px;
        }

        .search-bar:focus {
            border-color: var(--primary-accent);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .theme-toggle {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 1px solid var(--border-subtle);
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: var(--hover-bg);
            transform: rotate(20deg) scale(1.1);
        }

        .theme-icon {
            font-size: 18px;
        }

        /* Banner */
        .banner {
            position: relative;
            height: 85vh;
            display: flex;
            align-items: center;
            padding: 0 4%;
            background-size: cover;
            background-position: center;
            margin-top: 65px;
        }

        .banner::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(77deg, rgba(0,0,0,0.8) 0%, transparent 85%);
        }

        .banner-content {
            position: relative;
            z-index: 2;
            max-width: 550px;
        }

        .banner h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 16px;
            line-height: 1.1;
        }

        .banner p {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: 24px;
            line-height: 1.4;
        }

        .banner-buttons {
            display: flex;
            gap: 12px;
        }

        @keyframes buttonPulse {
            0% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(139, 92, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(139, 92, 246, 0); }
        }

        .btn {
            padding: 12px 32px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--primary-accent);
            color: #ffffff;
        }

        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(139, 92, 246, 0.4);
            animation: buttonPulse 1.5s infinite;
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-subtle);
        }

        .btn-secondary:hover {
            background: var(--hover-bg);
        }

        /* Genre Bar */
        .genre-bar {
            display: flex;
            gap: 12px;
            padding: 24px 4%;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .genre-bar::-webkit-scrollbar {
            display: none;
        }

        .genre-btn {
            padding: 8px 20px;
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
        }

        .genre-btn.active,
        .genre-btn:hover {
            background: var(--primary-accent);
            color: #ffffff;
            border-color: var(--primary-accent);
            box-shadow: var(--shadow-sm);
        }

        /* Movie Rows */
        .row {
            padding: 32px 4% 0;
        }

        .row h2 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .list {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 8px 0;
            scrollbar-width: thin;
            scrollbar-color: #4a4a4a var(--bg-card);
        }

        .list::-webkit-scrollbar {
            height: 8px;
        }

        .list::-webkit-scrollbar-track {
            background: var(--bg-card);
        }

        .list::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 4px;
        }

        @keyframes cardSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .movie-card {
            position: relative;
            min-width: 200px;
            height: 300px;
            cursor: pointer;
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
                        box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
                        z-index 0s 0.4s;
            box-shadow: var(--shadow-sm);
            animation: cardSlideIn 0.5s ease-out backwards;
        }

        .movie-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .movie-card:hover {
            transform: scale(1.1) translateY(-8px);
            box-shadow: 0 16px 32px rgba(139, 92, 246, 0.4), var(--shadow-md);
            z-index: 10;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
                        box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1), 
                        z-index 0s;
        }

        .movie-card:hover img {
            transform: scale(1.1);
        }

        .movie-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 16px;
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .movie-card:hover .movie-info {
            opacity: 1;
        }

        .movie-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .movie-rating {
            font-size: 12px;
            color: #46d369;
        }

        /* Modal */
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                backdrop-filter: blur(0px);
            }
            to {
                opacity: 1;
                backdrop-filter: blur(8px);
            }
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(8px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
            animation: modalFadeIn 0.3s ease-out;
        }

        .modal.active .modal-content {
            animation: modalSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-content {
            background: var(--bg-secondary);
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 20px 60px rgba(139, 92, 246, 0.3);
        }

        .modal-header {
            position: relative;
            height: 400px;
            background-size: cover;
            background-position: center;
        }

        .modal-header::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(transparent 50%, var(--bg-secondary) 100%);
        }

        .close {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(0,0,0,0.8);
            border: none;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: transform 0.2s;
        }

        .close:hover {
            transform: scale(1.1);
        }

        .modal-body {
            padding: 24px;
            max-height: 50vh;
            overflow-y: auto;
        }

        .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: var(--bg-card);
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 4px;
        }

        .modal-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .modal-meta {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            font-size: 14px;
            color: var(--text-secondary);
            flex-wrap: wrap;
        }

        .modal-description {
            font-size: 16px;
            line-height: 1.6;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        /* Tabs */
        .modal-tabs {
            display: flex;
            gap: 24px;
            border-bottom: 1px solid var(--border-subtle);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 0;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
        }

        .tab.active {
            color: var(--text-primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-accent);
            border-radius: 3px 3px 0 0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Server Selector */
        .server-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .server-btn {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .server-btn:hover {
            background: var(--hover-bg);
            border-color: var(--primary-accent);
        }

        .server-btn.active {
            background: var(--primary-accent);
            border-color: var(--primary-accent);
            color: #ffffff;
            box-shadow: var(--shadow-sm);
        }

        .video-player {
            width: 100%;
            height: 500px;
            border: none;
            border-radius: 4px;
            margin-bottom: 20px;
            background: var(--bg-card);
        }

        /* Cast Section */
        .cast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 16px;
        }

        .cast-item {
            text-align: center;
        }

        .cast-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .cast-name {
            font-size: 13px;
            font-weight: 600;
        }

        .cast-character {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Download Links */
        .download-link {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            margin-bottom: 12px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            transition: all 0.2s;
            text-decoration: none;
            color: var(--text-primary);
        }

        .download-link:hover {
            background: var(--hover-bg);
            border-color: var(--primary-accent);
            transform: translateX(4px);
        }

        .download-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .download-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .download-details h4 {
            margin: 0;
            font-size: 16px;
        }

        .download-details p {
            margin: 4px 0 0 0;
            font-size: 13px;
            color: var(--text-muted);
        }

        .download-arrow {
            font-size: 20px;
            color: var(--primary-accent);
        }

        /* Footer */
        .footer {
            padding: 48px 4%;
            margin-top: 80px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-subtle);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.2s;
            cursor: pointer;
        }

        .footer-links a:hover {
            color: var(--text-primary);
        }

        .footer-bottom {
            text-align: center;
            font-size: 12px;
            color: var(--text-muted);
            padding-top: 24px;
            border-top: 1px solid var(--border-subtle);
        }

        /* Loading */
        .loading {
            padding: 40px;
            text-align: center;
            color: var(--text-muted);
        }

        /* Info Modal */
        .info-modal h2 { 
            font-size: 28px; 
            margin-bottom: 20px; 
            color: var(--primary-accent); 
        }

        .info-modal h3 { 
            font-size: 20px; 
            margin-top: 24px; 
            margin-bottom: 12px; 
        }

        .info-modal p { 
            margin-bottom: 12px; 
            color: var(--text-secondary); 
            line-height: 1.6;
        }

        .info-modal ul { 
            margin-left: 20px; 
            margin-bottom: 16px; 
        }

        .info-modal li { 
            margin-bottom: 8px; 
            color: var(--text-secondary); 
        }

        .info-modal strong { 
            color: var(--text-primary); 
        }

        /* Responsive */
        @media (max-width: 768px) {
            .banner h1 { font-size: 32px; }
            .nav-links { gap: 16px; }
            .nav-links a { font-size: 13px; }
            .movie-card { min-width: 150px; height: 225px; }
            .modal-header { height: 250px; }
            .video-player { height: 300px; }
            .genre-bar { padding: 16px 4%; }
        }

        @media (max-width: 480px) {
            .navbar { padding: 12px 4%; }
            .navbar-logo img { height: 36px; width: 36px; }
            .banner { height: 70vh; }
            .banner h1 { font-size: 24px; }
            .banner p { font-size: 14px; }
            .btn { padding: 10px 24px; font-size: 14px; }
            .movie-card { min-width: 130px; height: 195px; }
            .row h2 { font-size: 20px; }
            .search-bar { min-width: 150px; }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-logo">
            <img src="logo.jpg" alt="MFS Logo">
        </div>
        <div class="nav-links">
            <a href="#" class="active">Home</a>
            <a href="#">Movies</a>
            <a href="#">TV Shows</a>
            <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Toggle theme">
                <span class="theme-icon">‚òÄÔ∏è</span>
            </button>
            <input type="text" class="search-bar" id="searchInput" placeholder="Search movies...">
        </div>
    </nav>

    <!-- Banner -->
    <div class="banner" id="banner">
        <div class="banner-content">
            <h1 id="bannerTitle">Loading...</h1>
            <p id="bannerOverview">Loading...</p>
            <div class="banner-buttons">
                <button class="btn btn-primary" id="bannerPlayBtn">‚ñ∂ Play</button>
                <button class="btn btn-secondary">‚Ñπ More Info</button>
            </div>
        </div>
    </div>

    <!-- Genre Filter -->
    <div class="genre-bar" id="genreBar">
        <button class="genre-btn active" data-genre="">All</button>
    </div>

    <!-- Movie Rows -->
    <div class="row">
        <h2>Trending Now</h2>
        <div class="list" id="trending"></div>
    </div>

    <div class="row">
        <h2>Popular</h2>
        <div class="list" id="popular"></div>
    </div>

    <div class="row">
        <h2>Top Rated</h2>
        <div class="list" id="topRated"></div>
    </div>

    <div class="row">
        <h2>Now Playing</h2>
        <div class="list" id="nowPlaying"></div>
    </div>

    <div class="row">
        <h2>Upcoming</h2>
        <div class="list" id="upcoming"></div>
    </div>

    <!-- Movie Modal -->
    <div class="modal" id="movieModal">
        <div class="modal-content">
            <button class="close" onclick="closeModal()">&times;</button>
            <div class="modal-header" id="modalHeader"></div>
            <div class="modal-body">
                <h2 class="modal-title" id="modalTitle"></h2>
                <div class="modal-meta" id="modalMeta"></div>
                
                <div class="modal-tabs">
                    <button class="tab active" onclick="showTab('player')">Player</button>
                    <button class="tab" onclick="showTab('details')">Details</button>
                    <button class="tab" onclick="showTab('cast')">Cast</button>
                    <button class="tab" onclick="showTab('download')">Download</button>
                </div>

                <div id="playerTab" class="tab-content active">
                    <div class="server-selector" id="serverSelector"></div>
                    <iframe id="videoPlayer" class="video-player" allowfullscreen allow="autoplay"></iframe>
                </div>

                <div id="detailsTab" class="tab-content">
                    <p class="modal-description" id="modalDescription"></p>
                    <div id="modalDetails"></div>
                </div>

                <div id="castTab" class="tab-content">
                    <div class="cast-grid" id="castGrid"></div>
                </div>

                <div id="downloadTab" class="tab-content">
                    <h3 style="margin-bottom: 16px;">Download Options</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">Choose a download server below. Click to open the download page in a new tab.</p>
                    <div id="downloadLinks"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div class="modal" id="infoModal">
        <div class="modal-content">
            <button class="close" onclick="closeInfoModal()">&times;</button>
            <div class="modal-body info-modal" id="infoModalContent"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-links">
            <a onclick="showDisclaimer()">Disclaimer</a>
            <a onclick="showAbout()">About Us</a>
            <a onclick="showContact()">Contact Us</a>
        </div>
        <div class="footer-bottom">
            &copy; 2025 MFS - Modern Fact Stories. All rights reserved.
        </div>
    </footer>

    <script>
        // API Configuration
        const API_KEY = 'f27081ffd1178848ff5106836b2adc93';
        const BASE_URL = 'https://api.themoviedb.org/3';
        const IMG_URL = 'https://image.tmdb.org/t/p/w500';
        const IMG_URL_ORIGINAL = 'https://image.tmdb.org/t/p/original';

        // Server providers
        const servers = [
            { name: 'VidSrc', url: (id) => `https://vidsrc.to/embed/movie/${id}` },
            { name: 'VidSrc 2', url: (id) => `https://vidsrc.cc/v2/embed/movie/${id}` },
            { name: '2Embed', url: (id) => `https://www.2embed.cc/embed/${id}` },
            { name: 'SuperEmbed', url: (id) => `https://www.superembed.stream/embed/movie?tmdb=${id}` },
            { name: 'AutoEmbed', url: (id) => `https://autoembed.cc/embed/movie/${id}` },
            { name: 'EmbedSu', url: (id) => `https://embed.su/embed/movie/${id}` },
            { name: 'SmashyStream', url: (id) => `https://embed.smashystream.com/playere.php?tmdb=${id}` },
            { name: 'MoviesAPI', url: (id) => `https://moviesapi.club/movie/${id}` }
        ];

        let currentMovie = null;
        let genres = [];

        // Fetch genres
        async function fetchGenres() {
            const res = await fetch(`${BASE_URL}/genre/movie/list?api_key=${API_KEY}`);
            const data = await res.json();
            genres = data.genres;
            renderGenres();
        }

        // Render genre buttons
        function renderGenres() {
            const genreBar = document.getElementById('genreBar');
            genres.forEach(genre => {
                const btn = document.createElement('button');
                btn.className = 'genre-btn';
                btn.textContent = genre.name;
                btn.dataset.genre = genre.id;
                btn.onclick = () => filterByGenre(genre.id, btn);
                genreBar.appendChild(btn);
            });
        }

        // Filter by genre
        function filterByGenre(genreId, btn) {
            document.querySelectorAll('.genre-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            if (genreId) {
                fetchMoviesByGenre(genreId);
            } else {
                loadMovies();
            }
        }

        // Fetch movies by genre
        async function fetchMoviesByGenre(genreId) {
            const res = await fetch(`${BASE_URL}/discover/movie?api_key=${API_KEY}&with_genres=${genreId}`);
            const data = await res.json();
            document.getElementById('trending').innerHTML = '';
            data.results.forEach(movie => {
                displayMovie(movie, 'trending');
            });
        }

        // Cache for API responses
        const movieCache = {};

        // Fetch movies with caching
        async function fetchMovies(endpoint, elementId) {
            const cacheKey = `${endpoint}_${elementId}`;
            
            // Check cache first (5 min expiry)
            if (movieCache[cacheKey] && Date.now() - movieCache[cacheKey].timestamp < 300000) {
                movieCache[cacheKey].data.forEach(movie => {
                    displayMovie(movie, elementId);
                });
                if (endpoint === 'popular' && movieCache[cacheKey].data.length > 0) {
                    setBanner(movieCache[cacheKey].data[0]);
                }
                return;
            }

            const res = await fetch(`${BASE_URL}/movie/${endpoint}?api_key=${API_KEY}&page=1`);
            const data = await res.json();
            
            // Cache the results
            movieCache[cacheKey] = {
                data: data.results,
                timestamp: Date.now()
            };
            
            data.results.forEach(movie => {
                displayMovie(movie, elementId);
            });

            // Set banner with first popular movie
            if (endpoint === 'popular' && data.results.length > 0) {
                setBanner(data.results[0]);
            }
        }

        // Set banner
        function setBanner(movie) {
            const banner = document.getElementById('banner');
            banner.style.backgroundImage = `url(${IMG_URL_ORIGINAL}${movie.backdrop_path})`;
            document.getElementById('bannerTitle').textContent = movie.title;
            document.getElementById('bannerOverview').textContent = movie.overview.substring(0, 150) + '...';
            document.getElementById('bannerPlayBtn').onclick = () => openModal(movie);
        }

        // Display movie card with Intersection Observer for lazy loading
        function displayMovie(movie, elementId) {
            if (!movie.poster_path) return;
            
            const movieCard = document.createElement('div');
            movieCard.className = 'movie-card';
            movieCard.innerHTML = `
                <img data-src="${IMG_URL}${movie.poster_path}" alt="${movie.title}" class="lazy-img" style="background: var(--bg-card);">
                <div class="movie-info">
                    <div class="movie-title">${movie.title}</div>
                    <div class="movie-rating">‚≠ê ${movie.vote_average.toFixed(1)}</div>
                </div>
            `;
            movieCard.onclick = () => openModal(movie);
            document.getElementById(elementId).appendChild(movieCard);
            
            // Lazy load image
            const img = movieCard.querySelector('img');
            imageObserver.observe(img);
        }

        // Intersection Observer for lazy loading
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.classList.remove('lazy-img');
                    observer.unobserve(img);
                }
            });
        }, { rootMargin: '50px' });

        // Open modal
        async function openModal(movie) {
            currentMovie = movie;
            const modal = document.getElementById('movieModal');
            
            // Set header background
            document.getElementById('modalHeader').style.backgroundImage = `url(${IMG_URL_ORIGINAL}${movie.backdrop_path})`;
            document.getElementById('modalTitle').textContent = movie.title;
            document.getElementById('modalDescription').textContent = movie.overview;
            
            // Meta info
            const releaseDate = new Date(movie.release_date).getFullYear();
            const genreNames = movie.genre_ids ? movie.genre_ids.map(id => {
                const genre = genres.find(g => g.id === id);
                return genre ? genre.name : '';
            }).filter(Boolean).join(', ') : '';
            
            document.getElementById('modalMeta').innerHTML = `
                <span>${releaseDate}</span>
                <span>‚≠ê ${movie.vote_average.toFixed(1)}</span>
                <span>${genreNames}</span>
            `;

            // Fetch full details
            const detailRes = await fetch(`${BASE_URL}/movie/${movie.id}?api_key=${API_KEY}`);
            const details = await detailRes.json();
            
            document.getElementById('modalDetails').innerHTML = `
                <p><strong>Runtime:</strong> ${details.runtime} minutes</p>
                <p><strong>Budget:</strong> $${details.budget.toLocaleString()}</p>
                <p><strong>Revenue:</strong> $${details.revenue.toLocaleString()}</p>
                <p><strong>Status:</strong> ${details.status}</p>
            `;

            // Fetch cast
            const castRes = await fetch(`${BASE_URL}/movie/${movie.id}/credits?api_key=${API_KEY}`);
            const castData = await castRes.json();
            const castGrid = document.getElementById('castGrid');
            castGrid.innerHTML = '';
            castData.cast.slice(0, 12).forEach(actor => {
                if (actor.profile_path) {
                    castGrid.innerHTML += `
                        <div class="cast-item">
                            <img src="${IMG_URL}${actor.profile_path}" alt="${actor.name}" loading="lazy">
                            <div class="cast-name">${actor.name}</div>
                            <div class="cast-character">${actor.character}</div>
                        </div>
                    `;
                }
            });

            // Render servers
            renderServers(movie.id);
            
            // Render download links
            renderDownloadLinks(movie.id, movie.title);
            
            modal.classList.add('active');
            showTab('player');
            
            // Auto-play video after modal opens
            setTimeout(() => {
                const videoPlayer = document.getElementById('videoPlayer');
                if (videoPlayer && videoPlayer.src) {
                    // Trigger play by reloading the iframe
                    const currentSrc = videoPlayer.src;
                    videoPlayer.src = currentSrc;
                }
            }, 500);
        }

        // Render server buttons
        function renderServers(movieId) {
            const selector = document.getElementById('serverSelector');
            selector.innerHTML = '';
            servers.forEach((server, index) => {
                const btn = document.createElement('button');
                btn.className = `server-btn ${index === 0 ? 'active' : ''}`;
                btn.textContent = server.name;
                btn.onclick = () => changeServer(server, btn, movieId);
                selector.appendChild(btn);
            });
            // Load first server
            document.getElementById('videoPlayer').src = servers[0].url(movieId);
        }

        // Change server
        function changeServer(server, btn, movieId) {
            document.querySelectorAll('.server-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById('videoPlayer').src = server.url(movieId);
        }

        // Render download links
        function renderDownloadLinks(movieId, movieTitle) {
            const downloadServers = [
                { 
                    name: 'Download Server 1', 
                    url: `https://dl.vidsrc.vip/movie/${movieId}`,
                    quality: '1080p / 720p / 480p'
                },
                { 
                    name: 'Download Server 2', 
                    url: `https://api.123moviestv.me/imdb/movie/${movieId}`,
                    quality: 'Multiple Quality Options'
                },
                { 
                    name: 'Download Server 3', 
                    url: `https://vadapav.mov/download?type=movie&id=${movieId}`,
                    quality: 'HD Quality'
                },
                { 
                    name: 'Torrent Download', 
                    url: `https://yts.mx/browse-movies/${encodeURIComponent(movieTitle)}/all/all/0/latest`,
                    quality: 'Multiple Quality Options'
                }
            ];

            const downloadLinks = document.getElementById('downloadLinks');
            downloadLinks.innerHTML = '';
            
            downloadServers.forEach(server => {
                const link = document.createElement('a');
                link.className = 'download-link';
                link.href = server.url;
                link.target = '_blank';
                link.rel = 'noopener noreferrer';
                link.innerHTML = `
                    <div class="download-info">
                        <div class="download-icon">‚¨á</div>
                        <div class="download-details">
                            <h4>${server.name}</h4>
                            <p>${server.quality}</p>
                        </div>
                    </div>
                    <div class="download-arrow">‚Üí</div>
                `;
                downloadLinks.appendChild(link);
            });
        }

        // Show tab
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            // Find and activate the correct tab button
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach((tab, index) => {
                if ((tabName === 'player' && index === 0) ||
                    (tabName === 'details' && index === 1) ||
                    (tabName === 'cast' && index === 2) ||
                    (tabName === 'download' && index === 3)) {
                    tab.classList.add('active');
                }
            });
            
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // Close modal
        function closeModal() {
            document.getElementById('movieModal').classList.remove('active');
            document.getElementById('videoPlayer').src = '';
        }

        // Debounced search
        let searchTimeout;
        document.getElementById('searchInput').addEventListener('input', async (e) => {
            const query = e.target.value.trim();
            clearTimeout(searchTimeout);
            
            if (query.length > 2) {
                searchTimeout = setTimeout(async () => {
                    const res = await fetch(`${BASE_URL}/search/movie?api_key=${API_KEY}&query=${query}`);
                    const data = await res.json();
                    document.getElementById('trending').innerHTML = '<div class="loading">Searching...</div>';
                    setTimeout(() => {
                        document.getElementById('trending').innerHTML = '';
                        if (data.results.length > 0) {
                            data.results.forEach(movie => {
                                displayMovie(movie, 'trending');
                            });
                        } else {
                            document.getElementById('trending').innerHTML = '<div class="loading">No results found</div>';
                        }
                    }, 300);
                }, 500);
            } else if (query.length === 0) {
                document.getElementById('trending').innerHTML = '<div class="loading">Loading...</div>';
                setTimeout(() => {
                    document.getElementById('trending').innerHTML = '';
                    fetchMovies('popular', 'trending');
                }, 300);
            }
        });

        // Navbar scroll effect
        window.addEventListener('scroll', () => {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 100) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });

        // Info modal functions
        function showDisclaimer() {
            const content = `
                <h2>Disclaimer</h2>
                <p><strong>Important Notice:</strong> This website does not host or store any video files on our servers.</p>
                
                <h3>Content Disclaimer</h3>
                <p>All content displayed on this website is sourced from third-party providers and APIs. We act solely as a search engine and indexing service, providing links to content hosted on external servers.</p>
                
                <h3>Copyright Notice</h3>
                <ul>
                    <li>We do not upload, host, or distribute any copyrighted content</li>
                    <li>All trademarks, logos, and content belong to their respective owners</li>
                    <li>We respect intellectual property rights and DMCA regulations</li>
                </ul>
                
                <h3>DMCA Compliance</h3>
                <p>If you believe that your copyrighted work has been improperly indexed or linked on our website, please contact us at <strong>rollonrenren@gmail.com</strong> with:</p>
                <ul>
                    <li>Description of the copyrighted work</li>
                    <li>URL of the content in question</li>
                    <li>Your contact information</li>
                    <li>A statement of good faith belief</li>
                </ul>
                
                <h3>Age Restriction</h3>
                <p>This website is intended for users 18 years and older. By using this site, you confirm that you meet the age requirement.</p>
                
                <h3>User Responsibility</h3>
                <p>Users are responsible for complying with local laws regarding streaming content. We are not liable for how users access or use external content.</p>
            `;
            showInfoModal(content);
        }

        function showAbout() {
            const content = `
                <h2>About Us</h2>
                <p><strong>Welcome to MFS - Modern Fact Stories</strong></p>
                
                <h3>Our Mission</h3>
                <p>We provide a modern, user-friendly platform for discovering and exploring movies. Our service aggregates publicly available information from various sources to help users find entertainment content.</p>
                
                <h3>What We Do</h3>
                <ul>
                    <li>Provide movie information and metadata from TMDb API</li>
                    <li>Index links to third-party streaming providers</li>
                    <li>Offer a clean, ad-light browsing experience</li>
                    <li>Help users discover trending and popular content</li>
                </ul>
                
                <h3>Technology</h3>
                <p>Our platform uses The Movie Database (TMDb) API for movie information and aggregates links from publicly available streaming providers. We do not control, host, or modify any video content.</p>
                
                <h3>Commitment to Users</h3>
                <ul>
                    <li>Fast, responsive interface</li>
                    <li>No registration required</li>
                    <li>Multiple server options for reliability</li>
                    <li>Regular updates and improvements</li>
                </ul>
                
                <h3>Legal Operation</h3>
                <p>We operate as a search and indexing service, similar to Google or other search engines. We comply with DMCA takedown requests and respect copyright holders' rights.</p>
            `;
            showInfoModal(content);
        }

        function showContact() {
            const content = `
                <h2>Contact Us</h2>
                <p>We're here to help! Please reach out for any inquiries, concerns, or copyright issues.</p>
                
                <h3>General Inquiries</h3>
                <p><strong>Email:</strong> rollonrenren@gmail.com</p>
                <p>We typically respond within 24-48 hours during business days.</p>
                
                <h3>DMCA / Copyright Claims</h3>
                <p>If you believe your copyrighted content has been improperly indexed, please send a DMCA notice to:</p>
                <p><strong>Email:</strong> rollonrenren@gmail.com</p>
                <p><em>Subject Line:</em> DMCA Takedown Request</p>
                
                <h3>Include in Your Request</h3>
                <ul>
                    <li>Your full name and contact information</li>
                    <li>Description of the copyrighted work</li>
                    <li>URL(s) of the content in question</li>
                    <li>Statement that you are the copyright owner or authorized agent</li>
                    <li>Good faith statement that use is unauthorized</li>
                    <li>Statement of accuracy under penalty of perjury</li>
                    <li>Physical or electronic signature</li>
                </ul>
                
                <h3>Technical Issues</h3>
                <p>For technical problems, bugs, or suggestions, please email us with:</p>
                <ul>
                    <li>Description of the issue</li>
                    <li>Device and browser information</li>
                    <li>Screenshots (if applicable)</li>
                </ul>
                
                <h3>Business Inquiries</h3>
                <p>For partnership or business opportunities, contact us at the email above.</p>
                
                <p><em>We are committed to responding promptly and addressing all concerns professionally.</em></p>
            `;
            showInfoModal(content);
        }

        function showInfoModal(content) {
            document.getElementById('infoModalContent').innerHTML = content;
            document.getElementById('infoModal').classList.add('active');
        }

        function closeInfoModal() {
            document.getElementById('infoModal').classList.remove('active');
        }

        // Close modals on outside click
        window.onclick = function(event) {
            const movieModal = document.getElementById('movieModal');
            const infoModal = document.getElementById('infoModal');
            if (event.target === movieModal) {
                closeModal();
            }
            if (event.target === infoModal) {
                closeInfoModal();
            }
        }

        // Load movies
        function loadMovies() {
            fetchMovies('popular', 'trending');
            fetchMovies('popular', 'popular');
            fetchMovies('top_rated', 'topRated');
            fetchMovies('now_playing', 'nowPlaying');
            fetchMovies('upcoming', 'upcoming');
        }

        // Theme toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            const icon = document.querySelector('.theme-icon');
            
            html.setAttribute('data-theme', newTheme);
            icon.textContent = newTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
            
            // Simple animation
            const toggle = document.getElementById('themeToggle');
            toggle.style.transform = 'rotate(360deg) scale(1.2)';
            setTimeout(() => {
                toggle.style.transform = '';
            }, 300);
        }

        // Check for saved theme preference or default to dark
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.querySelector('.theme-icon').textContent = savedTheme === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }

        // Initialize
        fetchGenres();
        loadMovies();
    </script>
</body>
</html>
